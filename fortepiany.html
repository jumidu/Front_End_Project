<!DOCTYPE html>
<html lang="pl">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pianina i Fortepiany - MusicStore</title>
    <link rel="stylesheet" href="style.css">
    <script src="theme.js"></script>
    <meta name="description" content="Page for buying pianos.">
</head>

<body>
    <div class="header">
        <div class="header-content">
            <div class="logo">
                <svg xmlns="http://www.w3.org/2000/svg" fill="currentColor" class="logo-icon" viewBox="0 0 16 16">
                    <path d="M6 13c0 1.105-1.12 2-2.5 2S1 14.105 1 13s1.12-2 2.5-2 2.5.896 2.5 2m9-2c0 1.105-1.12 2-2.5 2s-2.5-.895-2.5-2 1.12-2 2.5-2 2.5.895 2.5 2" />
                    <path fill-rule="evenodd" d="M14 11V2h1v9zM6 3v10H5V3z" />
                    <path d="M5 2.905a1 1 0 0 1 .9-.995l8-.8a1 1 0 0 1 1.1.995V3L5 4z" />
                </svg>
                <span class="logo-text">MusicStore</span>
            </div>

            <div class="nav-buttons">
                <button class="btn-icon" onclick="cycleFontSize()" title="Zmie≈Ñ rozmiar tekstu">A+</button>
                <button class="btn-icon-cart" onclick="openCartModal()">üõí Koszyk (0)</button>
                <button class="btn-icon" id="themeToggle" onclick="toggleDarkMode()">üåô</button>
            </div>
        </div>
    </div>

    <div class="nav-categories">
        <div class="nav-categories-content">
            <a href="index.html" class="nav-item">Wszystkie</a>
            <a href="gitary.html" class="nav-item">Gitary</a>
            <a href="fortepiany.html" class="nav-item">Fortepiany</a>
            <a href="keyboardy.html" class="nav-item">Keyboardy</a>
            <a href="wzmacniacze.html" class="nav-item">Wzmacniacze</a>
        </div>
    </div>

    <div class="breadcrumb">
        <div class="breadcrumb-content">
            <a href="index.html">Sklep</a> / <span>Pianina i Fortepiany</span>
        </div>
    </div>

    <div class="main-wrapper">
        <div class="products-container">
            <aside class="filters-sidebar">
                <div class="filters-header">
                    <h3>üîç Filtry</h3>
                </div>

                <div class="filter-group">
                    <h4 class="filter-title">MARKA</h4>
                    <div class="filter-options">
                        <label class="filter-checkbox">
                            <input type="checkbox" name="brand" value="kawai" onchange="filterProducts()">
                            <span>Kawai</span>
                        </label>
                        <label class="filter-checkbox">
                            <input type="checkbox" name="brand" value="yamaha" onchange="filterProducts()">
                            <span>Yamaha</span>
                        </label>
                    </div>
                </div>

                <div class="filter-group">
                    <h4 class="filter-title">CENA</h4>
                    <div class="filter-options">
                        <label class="filter-checkbox">
                            <input type="checkbox" name="price" value="budget" onchange="filterProducts()">
                            <span>Poni≈ºej 60 000 z≈Ç</span>
                        </label>
                        <label class="filter-checkbox">
                            <input type="checkbox" name="price" value="mid" onchange="filterProducts()">
                            <span>60 000 - 180 000 z≈Ç</span>
                        </label>
                        <label class="filter-checkbox">
                            <input type="checkbox" name="price" value="premium" onchange="filterProducts()">
                            <span>Powy≈ºej 180 000 z≈Ç</span>
                        </label>
                    </div>
                </div>

                <button class="btn-filter" onclick="clearFilters()">Wyczy≈õƒá filtry</button>
            </aside>

            <main class="content-area">
                <div class="content-header">
                    <h1 class="section-title">üéπ Pianina i Fortepiany</h1>
                    
                    <div class="sort-bar">
                        <label for="sortPrice">Sortuj wg ceny:</label>
                        <select id="sortPrice" onchange="filterProducts()">
                            <option value="">Domy≈õlnie</option>
                            <option value="asc">Cena rosnƒÖco</option>
                            <option value="desc">Cena malejƒÖco</option>
                        </select>
                    </div>

                    <p class="result-count">Wynik√≥w: <span id="resultCount">0</span></p>
                </div>

                <div class="products-list" id="productsGrid"></div>
            </main>
        </div>
    </div>

    <div id="productModal" class="modal">
        <div class="modal-content">
            <span class="close-btn" onclick="closeModal()">&times;</span>
            <div class="modal-image" id="modalImage">üéπ</div>
            <div class="modal-info">
                <h2 class="modal-title" id="modalTitle">Nazwa Produktu</h2>
                <p class="modal-specs" id="modalSpecs">-</p>
                <p class="modal-price" id="modalPrice">0 z≈Ç</p>
                <p class="modal-description" id="modalDescription">Opis...</p>

                <div class="audio-section">
                    <label class="audio-label">üéµ Pos≈Çuchaj brzmienia</label>
                    <audio id="pianoAudio" class="audio-player" controls>
                        <source src="sound/Chopin - Nocturne in E Flat Major (Op. 9 No. 2).mp3" type="audio/mpeg">
                        Twoja przeglƒÖdarka nie obs≈Çuguje audio.
                    </audio>
                </div>

                <div class="modal-buttons">
                    <button class="btn-modal btn-buy" onclick="addToCartFromModal()">üõí Dodaj do koszyka</button>
                    <button class="btn-modal btn-close" onclick="closeModal()">Zamknij</button>
                </div>
            </div>
        </div>
    </div>

    <div id="cartModal" class="modal">
        <div class="modal-content" style="max-width: 700px;">
            <span class="close-btn" onclick="closeCartModal()">&times;</span>
            <h2 class="section-title" style="font-size: 24px;">Tw√≥j Koszyk</h2>
            <div id="cartItemsContainer" class="cart-items-list"></div>
            <div class="cart-summary">
                <span>Suma:</span>
                <span id="cartTotalDisplay">0 z≈Ç</span>
            </div>
            <div class="modal-buttons">
                <button class="btn-modal btn-buy" onclick="checkout()">‚úÖ Zamawiam</button>
                <button class="btn-modal btn-close" onclick="closeCartModal()">Wr√≥ƒá</button>
            </div>
        </div>
    </div>

    <div class="footer">
        <p class="footer-text">¬© 2025 MusicStore. Wszystkie prawa zastrze≈ºone. | Autoryzowany dealer Yamaha & Kawai</p>
    </div>

    <script src="cart.js"></script>
    <script src="accessibility.js"></script>

    <script>
        const products = [
            { id: 1, name: 'Yamaha GB1K PE', brand: 'Yamaha', type: 'Pianino', price: 52000, specs: 'D≈Çugo≈õƒá: 151 cm, Wyko≈Ñczenie: Polished Ebony', desc: 'Akustyczny fortepian typu ‚Äûbaby grand‚Äù, ≈ÇƒÖczƒÖcy brzmienie zbli≈ºone do wiƒôkszych fortepian√≥w z kompaktowym rozmiarem.', image: 'images/yamaha-gb1k-pe.jpg' },
            { id: 2, name: 'Kawai GL10 WH', brand: 'Kawai', type: 'Pianino', price: 51000, specs: 'D≈Çugo≈õƒá: 150 cm, Wyko≈Ñczenie: White Polished', desc: 'Przystƒôpny cenowo fortepian, oferujƒÖcy wyjƒÖtkowƒÖ stabilno≈õƒá stroju dziƒôki mechanizmowi Millennium III.', image: 'images/kawai-gl-10-wh.jpg' },
            { id: 3, name: 'Kawai GX 2 WH/P', brand: 'Kawai', type: 'Pianino', price: 125000, specs: 'D≈Çugo≈õƒá: 180 cm, Wyko≈Ñczenie: White Polished', desc: 'Wykonany z najwy≈ºszƒÖ staranno≈õciƒÖ instrument, kt√≥ry otrzyma≈Ç nagrodƒô "Product Excellence Award".', image: 'images/Kawai-GX-2-W-BWP.jpg' },
            { id: 4, name: 'Kawai GX 7', brand: 'Kawai', type: 'Pianino', price: 220000, specs: 'D≈Çugo≈õƒá: 229 cm, Wyko≈Ñczenie: Polished Ebony', desc: 'Zaprojektowany z my≈õlƒÖ o najbardziej wymagajƒÖcych pianistach i salach koncertowych. Potƒô≈ºne brzmienie.', image: 'images/kawai-gx-7.jpg' }
        ];

        let currentProductId = null;

        const params = new URLSearchParams(window.location.search);
        const productId = params.get('product');

        if (productId) {
            const id = parseInt(productId);
            const productExists = products.some(p => p.id === id);

            if (productExists) {
                openModal(id);
            }
        }

        displayProducts(products);

        function displayProducts(filtered) {
            const grid = document.getElementById('productsGrid');
            grid.innerHTML = '';

            filtered.forEach(p => {
                const item = document.createElement('div');
                item.className = 'product-list-item';
                item.innerHTML = `
                    <img src="${p.image}" alt="${p.name}" class="product-list-image" style="object-fit: contain; background: white;">
                    <div class="product-list-info">
                        <div class="product-list-brand">${p.brand}</div>
                        <h3 class="product-list-name">${p.name}</h3>
                        <div class="product-list-price">${p.price.toLocaleString()} z≈Ç</div>
                        <button class="btn-details" onclick="openModal(${p.id})">Szczeg√≥≈Çy</button>
                    </div>
                `;
                grid.appendChild(item);
            });

            document.getElementById('resultCount').textContent = filtered.length;
        }

        function filterProducts() {
            const brands = Array.from(document.querySelectorAll('input[name="brand"]:checked')).map(cb => cb.value);
            const prices = Array.from(document.querySelectorAll('input[name="price"]:checked')).map(cb => cb.value);

            let filtered = [...products];

            if (brands.length > 0) {
                filtered = filtered.filter(p => brands.includes(p.brand.toLowerCase()));
            }

            if (prices.length > 0) {
                filtered = filtered.filter(p => {
                    if (prices.includes('budget') && p.price < 60000) return true;
                    if (prices.includes('mid') && p.price >= 60000 && p.price <= 180000) return true;
                    if (prices.includes('premium') && p.price > 180000) return true;
                    return false;
                });
            }

            // Obs≈Çuga Sortowania
            const sortValue = document.getElementById('sortPrice').value;
            if (sortValue === 'asc') filtered.sort((a, b) => a.price - b.price);
            else if (sortValue === 'desc') filtered.sort((a, b) => b.price - a.price);

            displayProducts(filtered);
        }

        function openModal(productId) {
            currentProductId = productId;
            const p = products.find(prod => prod.id === productId);
            
            document.getElementById('modalTitle').textContent = p.name;
            document.getElementById('modalSpecs').textContent = `${p.specs} | Marka: ${p.brand}`;
            document.getElementById('modalPrice').textContent = p.price.toLocaleString() + ' z≈Ç';
            document.getElementById('modalDescription').textContent = p.desc;
            document.getElementById('modalImage').innerHTML = `<img src="${p.image}" alt="${p.name}" style="width: 100%; height: 100%; object-fit: contain;">`;
            
            document.getElementById('productModal').classList.add('show');
        }

        function closeModal() {
            document.getElementById('productModal').classList.remove('show');
            // Zatrzymanie audio po zamkniƒôciu
            const audio = document.getElementById('pianoAudio');
            audio.pause();
            audio.currentTime = 0;
        }

        function clearFilters() {
            document.querySelectorAll('input[type="checkbox"]').forEach(cb => cb.checked = false);
            document.getElementById('sortPrice').value = "";
            filterProducts();
        }

        function addToCartFromModal() {
            const p = products.find(prod => prod.id === currentProductId);
            if (typeof addToCartGlobal === 'function') {
                addToCartGlobal(p.id, p.name, p.price, p.image);
            } else {
                alert("Dodano do koszyka: " + p.name);
            }
            closeModal();
        }

        // Zamykanie modala po klikniƒôciu poza tre≈õƒá
        window.onclick = function(event) {
            const pModal = document.getElementById('productModal');
            const cModal = document.getElementById('cartModal');
            if (event.target === pModal) closeModal();
            if (event.target === cModal) closeCartModal();
        }

        // Inicjalizacja widoku
        displayProducts(products);
    </script>
</body>

</html>